<!DOCTYPE html>
<html>
  
<head>
  <meta charset="UTF-8">
  <title>Recurring sequence diagram</title>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<!-- script src="https://raw.githubusercontent.com/kbwood/svg/blob/Release_1_4_5/jquery.svg.js"></script>
<link rel="stylesheet" type="text/css" href="https://raw.githubusercontent.com/kbwood/svg/blob/Release_1_4_5/jquery.svg.css" -->
<script type="text/javascript" src="recurrence.js"></script>
<script>
  function id(x) {return x;}
  
  var expr = "cos(x)";
  var axes;
  var a_0 = 5.0;


  function expr_f(x) {
    var cos = Math.cos;
    var sin = Math.sin;
    var sqrt = Math.sqrt;
    var pow = Math.pow;
    return eval(expr);
  }

  function draw() {
    $("#a0").html(""+a_0);
    expr = $("#expr").val();
    $("#expr_an").html(expr.replace("x","a(n)"));
    var canvas = $("#canvas")[0];
    if (null==canvas || !canvas.getContext) return;

    var ctx=canvas.getContext("2d");
    var x0 = .5 + .5*canvas.width;  // x0 pixels from left to x=0
    var y0 = .5 + .5*canvas.height; // y0 pixels from top to y=0
    var scale = 80;                 // 40 pixels from x=0 to x=1
    var doNegativeX = true;
    axes = new Axes(x0, y0, scale, doNegativeX);

    axes.update_svg($("svg"));

    ctx.clearRect ( 0 , 0 , canvas.width, canvas.height );
    axes.show(ctx);
    ctx.strokeStyle = "rgb(66,44,255)";
    ctx.lineWidth = 2;
    funGraph(ctx, axes, expr_f);
    ctx.strokeStyle = "rgb(200,200,0)";
    funGraph(ctx, axes, id);
    ctx.strokeStyle = "rgb(0,0,0)";
    ctx.lineWidth = 1;
    recurrenceWeb(ctx, axes, expr_f, a_0, 100);
  }

  function get_circle() {
      var circle = new_svg_elem("circle");
      circle.attr("cx",100);
      circle.attr("cy",100);
      circle.attr("r",50);
      circle.attr("style","stroke:blue;fill:none");
      return circle;
  }
  
  $(function() {
     $("#expr").keyup(function(event) {
         if (event.keyCode == 13)
            draw();
     });

     $("#draw").click(function() {
         draw();
     });
  
     $("#canvas").on("mousemove",function(event) {
       var coords = axes.mouse_coords(canvas,event);
       $("#x").html(""+coords.x);
       $("#y").html(""+coords.y);
     });

     $("#canvas").on("mousedown",function(event) {
       var coords = axes.mouse_coords(canvas,event);
       a_0 = coords.x;
       draw();
     });

     draw();
  });

</script>
</head>
<body onload="draw()">
Function: <input id="expr" value="cos(x)"><input id="draw" type="submit" value="draw"> x=<span id="x">?</span>, y=<span id="y">?</span><br />
a(n+1) = <span id="expr_an">?</span>, a_0 = <span id="a0">?</span><br />
<canvas id="canvas" width="640" height="480"></canvas>

<svg id="svg" width="640" height="480">
  <path id="graph"
	d="M 0 400 L 100 300 L 200 350 L 300 50 L 400 10 L 500 90 L 640 50 "
	style="stroke:blue;stroke-width:2;fill:none" />
  <line id="bisector" x1="0" y1="480" x2="640" y2="0" 
	style="stroke:yellow;stroke-width:2" />
</svg>
<p>Source on <a href='https://github.com/paolini/recurrence/'>github</a>


</body>
</html>
