(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{5042:function(){},862:function(e,t,r){Promise.resolve().then(r.bind(r,3711))},3711:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return D}});var n=r(9268),o=r(6006),a=r(7913),l=r.n(a);function i(e){let[t,r]=e;return t}function c(e,t){let[r,n]=e;return[r[t],e=>n(r=>({...r,[t]:e(r[t])}))]}function s(e,t){let[r,n]=e;n(()=>t)}function d(e,t){let[r,n]=e;n(t)}function x(e,t){let[r,n]=e;return r.map((e,r)=>t([e,t=>n(r=>r.map(r=>r===e?t(r):r))],r))}var u=r(1400);function h(e,t,r,n){let o=t/2,a=r/2,l=Math.sqrt(o*o+a*a)/e.r,i=o-e.x*l,c=a+e.y*l,s=e.r,d=e=>i+e*l,x=e=>c-e*l,h=e=>(e-i)/l,f=e=>(c-e)/l;return{ctx:n,width:t,height:r,scale:l,x0:i,y0:c,radius:s,xMin:h(0),xCenter:e.x,xMax:h(t),yMin:f(r),yCenter:e.y,yMax:f(0),xoff:(t/2-i)/l,yoff:(c-r/2)/l,pixel_x:d,pixel_y:x,x_pixel:h,y_pixel:f,clear:()=>n.clearRect(0,0,t,r),moveTo:(e,t)=>n.moveTo(d(e),x(t)),lineTo:(e,t)=>n.lineTo(d(e),x(t)),drawPoint:(e,t)=>{n.beginPath(),n.arc(d(e),x(t),2,0,2*Math.PI,!1),n.stroke()},drawText:(e,t,r)=>n.fillText(r,d(e)-2,x(t)+10),drawArrowHead:(e,t,r,o)=>{let a=Math.sqrt(r*r+o*o);r/=a,o/=-a,e=d(e),t=x(t),n.beginPath(),n.moveTo(e-7*r-2.1*o,t-7*o+2.1*r),n.lineTo(e,t),n.lineTo(e-7*r+2.1*o,t-7*o-2.1*r),n.stroke()},drawAxes:()=>{n.beginPath(),n.strokeStyle="rgb(128,128,128)",n.moveTo(0,c),n.lineTo(t,c),n.moveTo(i,0),n.lineTo(i,r),n.stroke();var e,o,a=Math.pow(10,Math.floor(Math.log(s/2)/Math.log(10)));function l(e){return(0,u.WUZ)(e,{precision:14})}n.font="10px Arial";var p=1,g=-1;(e=x(0))<0&&(e=0,p=-1),e>r&&(e=r,g=1),n.textAlign="center";for(var v=Math.floor(h(0)/a*10)+1;v<h(t)/a*10;v++)0!=v&&(o=d(v*a/10),n.beginPath(),n.moveTo(o,e),n.lineTo(o,e-p*(v%10==0?6:v%5==0?4:2)),n.stroke(),v%10==0&&n.fillText("".concat(l(v*a/10)),o,e-10*g));p=1,g=-1,o=d(0),n.textAlign="right",o<0&&(o=0,g=4,n.textAlign="left"),o>t&&(o=t,p=-1,g=-4);for(var v=Math.floor(f(r)/a*10)+1;v<f(0)/a*10;v++)0!=v&&(e=x(v*a/10),n.beginPath(),n.moveTo(o,e),n.lineTo(o+p*(v%10==0?6:v%5==0?4:2),e),n.stroke(),v%10==0&&n.fillText("".concat(l(v*a/10)),o+2*g,e+3))}}}var f=r(3118);function p(e){let{axes:t,plot:r,click:a,info:l}=e,c=(0,o.useRef)(null),[d,x]=(0,o.useState)({x:0,y:0}),[u,p]=(0,o.useState)(!1),[g,v]=(0,o.useState)(!1),[y,m]=(0,o.useState)(null),[j,w]=(0,o.useState)(0);(0,o.useEffect)(()=>(m(c.current),window.addEventListener("resize",M),()=>window.removeEventListener("resize",M)),[]),y&&(y.width=y.clientWidth,y.height=y.clientHeight,l.width=y.width,l.height=y.height,l.exportPdf=function(){let e=(null==y?void 0:y.width)||640,n=(null==y?void 0:y.height)||480;console.log("export Pdf ".concat(e,"x").concat(n));let o=new f.kH({unit:"pt",format:[e+20,n+20],orientation:n>e?"p":"l"});o.setLineJoin("rounded");let a=o.context2d;a.autoPaging=!1,console.log("autopaging: "+a.autoPaging),o.setFontSize(10),a.translate(10,10),a.scale(1,1);let l=h(i(t),e,n,a);r(l),o.save("funplot.pdf")});let b=y?function(e,t){let r=t.getContext("2d");if(null===r)return null;let n=h(e,t.width,t.height,r);return{...n,mouseCoords:e=>{let r=function(e,t){let r=e.getBoundingClientRect();return{x:t.clientX-r.left,y:t.clientY-r.top}}(t,e);return{x:n.x_pixel(r.x),y:n.y_pixel(r.y)}}}}(i(t),y):null;function M(){w(e=>e+1)}function k(e,r,n){if(b){var o,a;s(t,(o=i(t),a=Math.exp(e/40),{x:r+(o.x-r)/a,y:n+(o.y-n)/a,r:o.r/a}))}}return b&&r(b),(0,n.jsx)("canvas",{className:"h-full w-full",ref:c,onMouseDown:function(e){b&&(document.body.style.userSelect="none",x(b.mouseCoords(e)),v(!1),p(!0))},onMouseMove:function(e){if(!b)return;let r=b.mouseCoords(e);if(u){var n,o,a;s(t,(n=i(t),o=d.x-r.x,a=d.y-r.y,{x:n.x+o,y:n.y+a,r:n.r}))}l.x=r.x,l.y=r.y,v(!0)},onMouseUp:function(e){if(!b)return;let t=b.mouseCoords(e);g||a(t),v(!1),p(!1)},onScroll:function(e){console.log("onScroll"),b&&k(-e.detail,l.x,l.y)},onWheel:function(e){k(-e.deltaY/40,l.x,l.y)},onBlur:()=>p(!1)})}var g=r(2387);function v(e,t,r,n,o,a){var l=e.x_pixel(0),i=e.y_pixel(e.height),c=e.x_pixel(e.width),s=e.y_pixel(0);let d=e.radius/Math.sqrt(e.width*e.width+e.height*e.height),x=a&&a.draw_arrows,u=a&&a.equation;for(let N=1;N>=-1;N-=2){var h=e.width,f=n,p=o,g=[];e.ctx.beginPath(),e.moveTo(f,p);for(var v=0;f<=c&&f>=l&&p<=s&&p>=i&&(v<h||u);v++){var y=t(f,p),m=r(f,p);if(isNaN(y)||isNaN(m))break;var j=d/Math.sqrt(y*y+m*m);if(u&&Math.abs(m)>e.height||j>2&&!u)break;var w=N*j;let n=f+w*y,o=p+w*m;if(y=.5*(y+t(n,o)),m=.5*(m+r(n,o)),f+=w*y,p+=w*m,e.lineTo(f,p),x&&v%160==80&&g.push([f,p,y,m]),a.grid_points&&a.grid_distance)for(var b=a.grid_distance*a.grid_distance,M=a.grid_points,k=0;k<M.length;++k){var y=M[k][0]-f,m=M[k][1]-p;y*y+m*m<=b&&(M.splice(k,1),k--)}}e.ctx.stroke();for(var k=0;k<g.length;++k)e.drawArrowHead(g[k][0],g[k][1],g[k][2],g[k][3])}}function y(e,t,r,n,o){e.ctx.strokeStyle=t.color;try{var a={draw_arrows:!o,equation:o,grid_points:[],grid_distance:0,grid_count:t.gridCount};if(t.gridPoints){var l=e.radius/t.gridCount;a.grid_distance=Math.sqrt(2)*l/1.99;for(var i=e.xMin+l/2;i<e.xMax;i+=l)for(var c=e.yMin+l/2;c<e.yMax;c+=l)a.grid_points.push([i,c])}t.drawSlope&&(e.ctx.lineWidth=2,e.ctx.strokeStyle=t.slopeColor,function(e,t,r,n){for(var o=e.x_pixel(0),a=e.y_pixel(e.height),l=e.x_pixel(e.width),i=e.y_pixel(0),c=(l-o)/40,s=(n?.5:.3)*c,d=o+.5*c;d<l;d+=c)for(var x=a+.5*c;x<i;x+=c){var u=t(d,x),h=r(d,x),f=s/Math.sqrt(u*u+h*h);e.ctx.beginPath(),e.moveTo(d,x);var p=d+f*u,g=x+f*h;e.lineTo(p,g),e.ctx.stroke(),n&&e.drawArrowHead(p,g,u,h)}}(e,r,n,!o)),e.ctx.lineWidth=1,e.ctx.strokeStyle=t.color;for(var s=0;s<t.points.length;++s)v(e,r,n,t.points[s].x,t.points[s].y,a);for(;;){let t=a.grid_points.pop();if(void 0===t)break;let[o,l]=t;v(e,r,n,o,l,a)}}catch(e){console.error(e)}}var m=r(6235);r(5418);var j=r(7696);function w(e){let{state:t,figure:r,active:o}=e,a=c(t,"color"),l=c(t,"expr");return(0,n.jsx)(N,{tex:r.tex,color:a,active:o,children:(0,n.jsxs)("div",{className:"flex flex-row px-2 items-center",children:[(0,n.jsx)("span",{children:i(t).inverted?"x=f(y)=":"y=f(x)="}),(0,n.jsx)(P,{expr:l})]})})}function b(e){let{state:t,figure:r,active:o}=e,a=c(t,"color"),l=c(t,"expr");return(0,n.jsxs)(N,{color:a,active:o,tex:r.tex,children:[(0,n.jsx)("span",{children:"y(x)="}),(0,n.jsx)(P,{expr:l})]})}function M(e){let{state:t,figure:r,active:o}=e,a=c(t,"color"),l=c(t,"expr"),s=c(t,"drawSlope"),d=c(t,"gridPoints");return(0,n.jsx)(N,{active:o,tex:r.tex,color:a,children:(0,n.jsxs)("div",{className:"flex flex-col",children:[(0,n.jsxs)("div",{className:"flex",children:[(0,n.jsx)(z,{value:s,children:"draw slope field"}),(0,n.jsx)(z,{value:d,children:"fill plane"}),(0,n.jsx)(S,{}),(0,n.jsx)("span",{children:"y' = "}),(0,n.jsx)(P,{expr:l})]}),(0,n.jsx)(E,{points:c(t,"points"),gridPoints:i(d)})]})})}function k(e){let{state:t,figure:r,active:o}=e,a=c(t,"color"),l=c(t,"slopeColor"),s=c(t,"exprX"),d=c(t,"exprY"),x=c(t,"drawSlope"),u=c(t,"gridPoints"),h=c(t,"points");return(0,n.jsx)(N,{active:o,tex:r.tex,color:a,children:(0,n.jsxs)("div",{className:"flex flex-col",children:[(0,n.jsxs)("div",{className:"flex flex-row",children:[(0,n.jsx)(_,{value:x,color:l}),(0,n.jsx)(z,{value:u,children:"fill plane"}),(0,n.jsx)(S,{}),(0,n.jsx)("table",{children:(0,n.jsxs)("tbody",{children:[(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{className:"text-right min-w-max whitespace-nowrap",children:"x' = f(x,y)"}),(0,n.jsxs)("td",{className:"min-w-max whitespace-nowrap",children:["= ",(0,n.jsx)(P,{expr:s})]})]}),(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{className:"text-right min-w-max whitespace-nowrap",children:"y' = g(x,y)"}),(0,n.jsxs)("td",{className:"min-w-max whitespace-nowrap",children:["= ",(0,n.jsx)(P,{expr:d})]})]})]})})]}),(0,n.jsx)(E,{points:h,gridPoints:i(u)})]})})}function N(e){let{active:t,color:r,children:o,tex:a}=e;return(0,n.jsxs)("div",{className:"flex flex-row items-center",children:[(0,n.jsx)(C,{color:r,active:t}),(0,n.jsx)(T,{tex:a,active:t}),i(t)&&(0,n.jsx)(S,{}),i(t)&&o]})}function _(e){let{value:t,color:r}=e;return(0,n.jsxs)("div",{className:"flex flex-row items-center",children:[i(t)&&(0,n.jsx)(C,{className:"flex mr-1",color:r}),(0,n.jsx)(z,{value:t,children:"draw slope field"})]})}function C(e){let{color:t,active:r,className:a}=e,l=(0,o.useState)(!1),c=!r||i(r);return(0,n.jsxs)("div",{className:"inline",children:[(0,n.jsx)("div",{className:(a||"")+" w-5 h-5 rounded m-1",style:{background:i(t)},onClick:()=>c?d(l,e=>!e):r&&s(r,!0)}),c&&i(l)&&(0,n.jsx)(m.gW,{className:"",color:i(t),onChange:e=>s(t,e)})]})}function T(e){let{tex:t,active:r}=e;return i(r)?(0,n.jsx)(j.Z,{className:"px-1 hover:bg-blue-300 border border-blue-200 hover:border-blue-400 rounded",math:t,onClick:()=>s(r,!1),block:!0}):(0,n.jsx)(j.Z,{className:"hover:bg-blue-300 hover:border rounded",math:t,onClick:()=>s(r,!0)})}function P(e){let{expr:t}=e;return(0,n.jsx)("input",{className:"h-8 border p-1 bg-blue-100",type:"text",value:i(t),onChange:function(e){let[t,r]=e;return e=>r(t=>e.target.value)}(t)})}function z(e){let{value:t,children:r}=e;return(0,n.jsxs)("label",{className:"flex flex-row items-center mx-1",children:[(0,n.jsx)("input",{className:"mr-1",type:"checkbox",checked:i(t),onChange:function(e){let[t,r]=e;return e=>r(t=>e.target.checked)}(t)}),r]})}function S(){return(0,n.jsx)("div",{className:"m-1 h-10 border-r-2 border-blue-400"})}function E(e){let{points:t,gridPoints:r}=e;return(0,n.jsx)("div",{className:"flex flex-wrap",children:i(t).length>0?i(t).map((e,r)=>(0,n.jsxs)("span",{className:"online hover:line-through hover:bg-blue-300 mr-1",onClick:()=>d(t,e=>e.filter((e,t)=>r!==t)),children:["(",Math.round(100*e.x)/100,", ",Math.round(100*e.y)/100,")"]},r)):!r&&(0,n.jsx)("span",{className:"online bg-red-300",children:" click on picture to draw an integral line or check 'fill plane'"})})}function q(e){let{messages:t}=e;return(0,n.jsx)("ul",{children:x(t,(e,r)=>{let o={info:"white",error:"red",warning:"yellow"}[i(e).type];return(0,n.jsxs)("li",{className:"bg-".concat(o," m-1 rounded"),children:[(0,n.jsx)("span",{className:"m-1 border hover:cursor-pointer hover:border-black",onClick:()=>(function(e,t){let[r,n]=e;n(e=>e.filter(e=>e!==i(t)))})(t,e),children:"[x]"}),i(e).message]},r)})})}function A(e,t){let[r,n]=e;return[t,function(e){n(r=>r.map(r=>{if(r.figure!==t)return r;{let n={...r,figure:e(t)};return n}}))}]}function Y(e){switch(e.t){case"graph":return{type:"graph",inverted:e.i,color:e.c,expr:e.e};case"implicit":return{type:"implicit",color:e.c,expr:e.e};case"ode_equation":return{type:"ode",color:e.c,slopeColor:e.sc,expr:"y^2+x",drawSlope:!1,gridPoints:!0,gridCount:20,points:[]};case"ode_system":return{type:"system",exprX:"y",exprY:"-sin(x)-y",color:"#4A90E2",slopeColor:"#7ED321",drawSlope:e.ds,drawArrows:e.da,gridPoints:e.gp,gridCount:20,points:e.l.map(e=>{let[t,r]=e;return{x:t,y:r}})}}}function D(){let e=(0,o.useState)({x:0,y:0,r:5}),t=(0,o.useState)([]),r=(0,o.useState)([]);(0,o.useEffect)(()=>{!function(){let r=window.location.hash;if("#q="!==r.substring(0,3))return;r=decodeURIComponent(r=r.substring(3));let n=JSON.parse(r);console.log("hash:",n),s(e,n.p);let o=n.l.map(e=>Y(e));s(t,o.map(e=>({figure:e,key:Math.random().toString(36).substring(7),active:!0})))}()},[]);let a=i(t).map(e=>(function(e){switch(e.type){case"graph":return function(e){let t=null,r=[],n="";try{let r=(0,g.MY)(e.expr);(t=e.inverted?e=>r.evaluate({y:e}):e=>r.evaluate({x:e}))(0)}catch(e){console.error(e),r.push("".concat(e))}try{n="".concat(e.inverted?"x":"y"," = ").concat((0,g.Qc)(e.expr).toTex())}catch(e){console.error(e),r.push("".concat(e))}return{state:e,plot:function(r){if(r.ctx.strokeStyle=e.color,t)try{!function(e,t,r){var n=r?(e.yMax-e.yMin)/e.height:(e.xMax-e.xMin)/e.width;e.ctx.beginPath();for(var o=r?e.yMin:e.xMin,a=t(o),l=1,i=n/10,c=n,s=r?e.yMax:e.xMax,d=r?e.xMin:e.yMin,x=r?e.xMax:e.yMax;o<s;){var u=o+c,h=t(u);if(isNaN(a)||isNaN(h))l=1;else if(h>x&&a>x)l=1;else if(h<d&&a<d)l=1;else{var f=h-a;if(Math.abs(f)>n){if(c>i){c*=.5;continue}}else c<n&&(c*=2);var p=0;if(Math.abs(f)>n){var g=o,v=u,y=a,m=.5*(a+h);for(p=0;p<10;++p){var j=.5*(g+v),w=t(j);if(isNaN(w)){p=10;break}if(Math.abs(w-m)<n)break;y<=m&&w>=m||y>=m&&w<=m?v=j:(g=j,y=w)}}if(p>=10)l=1;else{if(l){var b=o,M=a;a>x?b=o+((M=x)-a)/(h-a)*(u-o):a<d&&(b=o+((M=d)-a)/(h-a)*(u-o)),r?e.moveTo(M,b):e.moveTo(b,M)}var b=o,M=a;h>x?(b=u+((M=x)-h)/(a-h)*(o-u),l=1):h<d?(b=u+((M=d)-h)/(a-h)*(o-u),l=1):l=0,r?e.lineTo(M,b):e.lineTo(b,M)}}a=h,o=u}e.ctx.stroke()}(r,t,e.inverted)}catch(e){console.error(e)}},click:function(e,t){},tex:n,errors:r}}(e);case"implicit":return function(e){let t=null,r=[],n="";try{let r=(0,g.MY)(e.expr);(t=(e,t)=>r.evaluate({x:e,y:t}))(0,0)}catch(e){r.push("".concat(e))}try{n="".concat((0,g.Qc)(e.expr).toTex()," = 0")}catch(e){r.push("".concat(e))}return{state:e,plot:function(r){if(r.ctx.strokeStyle=e.color,t)try{!function(e,t,r,n){var o,a,l,i,c,s=[{}];function d(e,t){return e<0&&t>=0||e>=0&&t<0}function x(e,t,r){var n=e.adjacent[t];if(console.assert(n<s.length),0===n)return n;var o=s[n];if(t=(t+2)%4,r=1-r,o.depth<e.depth){var a=e.x,l=e.y,i=o.x0,c=o.y0,d=o.l,x=e.l;r*=x/d,(r+=[l-c,i+d-a-x,c+d-l-x,a-i][t]/o.l)<0?(console.assert(r>-.01),r=0):r>1&&(console.assert(r<1.1),r=1)}for(var e=o;0!==e.children[0];)r<.5?(r*=2,n=e.children[(t+3)%4]):(r=(r-.5)*2,n=e.children[t]),e=s[n];return n}function u(e){for(var r=e.x,n=e.y,o=e.l,a=0;a<4;++a)console.assert(.001>Math.abs(e.z[a]-t(r+[o,0,0,o][a],n+[o,o,0,0][a])))}function h(e,t){var r=e.z[(t+3)%4],n=r/(r-e.z[t]),o=e.l,a=e.x+[1,1,0,0][t]*o,l=e.x+[1,0,0,1][t]*o,i=e.y+[0,1,1,0][t]*o,c=e.y+[1,1,0,0][t]*o;return[(1-n)*a+n*l,(1-n)*i+n*c,n]}function f(e,t){var r=(t+2)%4;return e&1<<r||e&1<<(r=(t+1)%4)||e&1<<(r=(t+3)%4)?r:4}for(var p=e.x_pixel(0),g=e.y_pixel(e.height),v=e.x_pixel(e.width),y=e.y_pixel(0),m=2*e.radius/Math.sqrt(e.width*e.width+e.height*e.height),j=80*m,w=Array(100),b=0,M=0;M<w.length;++M)w[M]=0;for(var k=0,N=0,_=0,a=g;a<y;a+=j){k=_,_=s.length,N=0;for(var l=p;l<v;l+=j){var i={},c=s.length;i.x=l,i.y=a,i.depth=0,i.l=j,i.adjacent=[0,0,0,0],i.children=[0,0,0,0],i.flag=0,i.z=[0,0,0,0],i.z[0]=t(l+j,a+j),N?(i.adjacent[2]=N,s[N].adjacent[0]=c,i.z[1]=s[N].z[0],i.z[2]=s[N].z[3]):(i.z[1]=t(l,a+j),i.z[2]=k?s[k].z[1]:t(l,a)),N=c,k?(i.adjacent[3]=k,s[k].adjacent[1]=c,i.z[3]=s[k].z[0],k++):i.z[3]=t(l+j,a),console.assert(s.length==c),s.push(i),u(i);var C=50+Math.floor(Math.log(Math.abs(i.z[0])));C>=0&&C<w.length&&(w[C]++,b++)}}for(var T=0,M=0;M<w.length;++M)if(50*(T+=w[M])>b){o=Math.exp(M-50);break}for(;;){for(var c=1;c<s.length;++c){var i=s[c];if(!i.children[0])for(var P=0;P<4;++P){if(d(i.z[(P+3)%4],i.z[P])&&(i.flag=1,i.adjacent[P])){var z=s[i.adjacent[P]];z.depth<=i.depth&&!z.children[0]&&(z.flag=1)}i.depth<=2&&Math.abs(i.z[P])<o&&(i.flag=1)}}for(var S=!0,c=1;c<s.length;++c)s[c].flag&&s[c].l>m&&0===s[c].children[0]&&(function(e){for(var r=s.length,n=e.x,o=e.y,a=.5*e.l,l=t(n+a,o+a),i=[t(n+2*a,o+a),t(n+a,o+2*a),t(n,o+a),t(n+a,o)],c=[{},{},{},{}],d=0;d<4;++d){var x,h=c[d];console.assert(!e.children[d]),h.x=n+[1,0,0,1][d]*a,h.y=o+[1,1,0,0][d]*a,h.depth=e.depth+1,h.l=a,h.adjacent=[0,0,0,0],x=e.adjacent[d],h.adjacent[d]=x&&(s[x].children[(d+1)%4]||x),x=e.adjacent[(d+1)%4],h.adjacent[(d+1)%4]=x&&(s[x].children[(d+3)%4]||x),h.adjacent[(d+2)%4]=r+(d+1)%4,h.adjacent[(d+3)%4]=r+(d+3)%4,h.children=[0,0,0,0],h.flag=0,h.z=[0,0,0,0],h.z[d]=e.z[d],h.z[(d+1)%4]=i[(d+1)%4],h.z[(d+2)%4]=l,h.z[(d+3)%4]=i[d],u(h)}for(var d=0;d<4;++d)console.assert(s.length==r+d),s.push(c[d]),e.children[d]=r+d;for(var d=0;d<4;++d)for(var h=s[r+d],f=0;f<4;++f){var p=h.adjacent[f];if(p&&p<r){var g=s[p],v=(f+2)%4;g.depth==h.depth&&(g.adjacent[v]=r+d)}console.assert(h.adjacent[f]<s.length)}}(s[c]),S=!1),s[c].flag=0;if(S)break}for(var c=1;c<s.length;++c){var i=s[c];if(i.flag=0,!i.children[0])for(var P=0;P<4;++P)d(i.z[(P+3)%4],i.z[P])&&(i.flag|=1<<P)}for(var c=1;c<s.length;++c)for(var i=s[c];0!==i.flag;){var P=function(e){var t;for(t=0;t<4&&!(e&1<<t);++t);return t}(i.flag);console.assert(P<4);var E=f(i.flag,P),q=h(i,P);e.ctx.beginPath(),e.moveTo(q[0],q[1]),i.flag&=~(1<<P),E!==P&&(q=h(i,E),e.lineTo(q[0],q[1]),i.flag&=~(1<<E));for(var A=x(i,E,q[2]);0!==A;){i=s[A];var E=(E+2)%4;i.flag&=~(1<<E);var Y=f(i.flag,E);Y<4?(q=h(i,E=Y),e.lineTo(q[0],q[1]),i.flag&=~(1<<E),A=x(i,E,q[2])):(A==c&&e.ctx.closePath(),A=0)}e.ctx.stroke()}}(r,t)}catch(e){console.error(e)}},click:function(e,t){},tex:n,errors:r}}(e);case"ode":return function(e){let t=null,r=[],n="";try{let r=(0,g.MY)(e.expr);(t=(e,t)=>r.evaluate({x:e,y:t}))(0,0)}catch(e){r.push("".concat(e))}try{n="y' = ".concat((0,g.Qc)(e.expr.replace(/y/g,"y")).toTex())}catch(e){r.push("".concat(e))}return{state:e,plot:function(r){t&&y(r,e,(e,t)=>1,t,!0)},click:function(e,t){l()("ode"===e[0].type);let r=c(e,"points");d(r,e=>[...e,t])},tex:n,errors:r}}(e);case"system":return function(e){let t=null,r=null,n=[],o="";try{let n=(0,g.MY)(e.exprX),o=(0,g.MY)(e.exprY);t=(e,t)=>n.evaluate({x:e,y:t}),r=(e,t)=>o.evaluate({x:e,y:t}),t(0,0),r(0,0)}catch(e){n.push("".concat(e))}try{o="\n            \\begin{cases}\n            x' = ".concat((0,g.Qc)(e.exprX).toTex()," \\\\\n            y' = ").concat((0,g.Qc)(e.exprY).toTex()," \\\\\n            \\end{cases}")}catch(e){n.push("".concat(e))}return{state:e,plot:function(n){t&&r&&y(n,e,t,r,!1)},click:function(e,t){l()("system"===e[0].type);let r=c(e,"points");d(r,e=>[...e,t])},tex:o,errors:n}}(e)}})(e.figure)),u={x:0,y:0,height:0,width:0,exportPdf:()=>{}};function h(e){let t=e.figure;switch(t.type){case"graph":return{t:"graph",i:t.inverted,c:t.color,e:t.expr};case"implicit":return{t:"implicit",c:t.color,e:t.expr};case"ode":return{t:"ode_equation",c:t.color,sc:t.slopeColor,e:t.expr,ds:t.drawSlope,gp:t.gridPoints,l:t.points.map(e=>[e.x,e.y])};case"system":return{t:"ode_system",ex:t.exprX,ey:t.exprY,c:t.color,sc:t.slopeColor,ds:t.drawSlope,da:t.drawArrows,gp:t.gridPoints,l:t.points.map(e=>[e.x,e.y])}}}return(0,n.jsxs)("main",{className:"flex flex-col flex-1 bg-blue-200",children:[(0,n.jsxs)("div",{className:"block",children:[(0,n.jsxs)("div",{className:"flex flex-row",children:[(0,n.jsx)("span",{className:"font-bold mx-1",children:"FunPlot"}),(0,n.jsxs)("select",{value:"",className:"border mx-1",onChange:e=>(function(e){let r=Y((e=>{switch(e){case"graph":return{t:"graph",i:!1,c:"#f00",e:"x*sin(1/x)"};case"graph_inverted":return{t:"graph",i:!0,c:"#0f0",e:"y^2"};case"implicit":return{t:"implicit",c:"#00f",e:"x^4-x^2+y^2"};case"ode_equation":return{t:"ode_equation",c:"#4A90E2",sc:"#7ED321",e:"y^2+x",ds:!1,gp:!0,l:[]};case"ode_system":return{t:"ode_system",ex:"y",ey:"-sin(x)-y",c:"#4A90E2",sc:"#7ED321",ds:!1,da:!0,gp:!0,l:[]}}l()(!1,"invalid figure type ".concat(e))})(e));d(t,e=>[...e,{figure:r,key:Math.random().toString(36).substring(7),active:!0}])})(e.target.value),children:[(0,n.jsx)("option",{value:"",children:"choose plot type"}),(0,n.jsx)("option",{value:"graph",children:"graph y=f(x)"}),(0,n.jsx)("option",{value:"graph_inverted",children:"graph x=f(y)"}),(0,n.jsx)("option",{value:"implicit",children:"level curve f(x,y)=0"}),(0,n.jsx)("option",{value:"ode_equation",children:"ODE equation"}),(0,n.jsx)("option",{value:"ode_system",children:"ODE system"})]}),(0,n.jsxs)("select",{value:"",className:"border mx-1",onChange:n=>(function(n){switch(n){case"pdf":u.exportPdf&&u.exportPdf();break;case"share":let o=i(t),a={p:i(e),l:o.map(h)},l=encodeURIComponent(JSON.stringify(a));window.location.hash="#q=".concat(l);let c=document.createElement("textarea");c.value=window.location.href,document.body.appendChild(c),c.select(),document.execCommand("copy"),document.body.removeChild(c),d(r,e=>[...e,{type:"info",message:"link copied to clipboard"}])}})(n.target.value),children:[(0,n.jsx)("option",{value:"",children:"choose action"}),(0,n.jsx)("option",{value:"pdf",children:"export PDF"}),(0,n.jsx)("option",{value:"share",children:"share link"})]}),(0,n.jsxs)("span",{children:["x=",u.x]}),", ",(0,n.jsxs)("span",{children:["y=",u.y]})]}),function(){let[e,r]=t;return l()(e.length===a.length),e.map((e,r)=>{let o=e.figure,l=c(function(e,t){let[r,n]=e;return[t,e=>n(r=>r.map(r=>r===t?e(r):r))]}(t,e),"active");switch(o.type){case"graph":return(0,n.jsx)(w,{state:A(t,o),figure:a[r],active:l},e.key);case"implicit":return(0,n.jsx)(b,{state:A(t,o),figure:a[r],active:l},e.key);case"ode":return(0,n.jsx)(M,{state:A(t,o),figure:a[r],active:l},e.key);case"system":return(0,n.jsx)(k,{state:A(t,o),figure:a[r],active:l},e.key)}})}(),(0,n.jsx)(q,{messages:r})]}),(0,n.jsx)("div",{className:"flex-1 border-2 border-black h-8 bg-white",children:(0,n.jsx)(p,{axes:e,plot:function(e){console.log("plot!"),e.clear(),e.drawAxes(),a.forEach(t=>t.plot(e))},click:function(e){let r=x(t,e=>e),n=r.map(e=>c(e,"figure"));l()(a.length===r.length),l()(a.length===n.length),a.forEach((t,n)=>{i(r[n]).active&&t.click(c(r[n],"figure"),e)})},info:u})})]})}}},function(e){e.O(0,[638,546,898,253,769,744],function(){return e(e.s=862)}),_N_E=e.O()}]);